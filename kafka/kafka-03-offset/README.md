<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
**Table of Contents**  *generated with [DocToc](https://github.com/thlorenz/doctoc)*

- [offsetåç§»é‡è¡Œä¸º](#offset%E5%81%8F%E7%A7%BB%E9%87%8F%E8%A1%8C%E4%B8%BA)
  - [ç›®æ ‡](#%E7%9B%AE%E6%A0%87)
  - [é‡è¦Topicä¸æ¶ˆè´¹è€…ç»„](#%E9%87%8D%E8%A6%81topic%E4%B8%8E%E6%B6%88%E8%B4%B9%E8%80%85%E7%BB%84)
  - [æ ¸å¿ƒæ¦‚å¿µ](#%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5)
    - [åç§»é‡ç­–ç•¥å¯¹æ¯”](#%E5%81%8F%E7%A7%BB%E9%87%8F%E7%AD%96%E7%95%A5%E5%AF%B9%E6%AF%94)
    - [é‡è¦è¯´æ˜](#%E9%87%8D%E8%A6%81%E8%AF%B4%E6%98%8E)
  - [æŠ€æœ¯å®ç°](#%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0)
    - [1. é¡¹ç›®ä¾èµ–](#1-%E9%A1%B9%E7%9B%AE%E4%BE%9D%E8%B5%96)
    - [2. åº”ç”¨é…ç½®](#2-%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE)
    - [3. å¸¸é‡å®šä¹‰](#3-%E5%B8%B8%E9%87%8F%E5%AE%9A%E4%B9%89)
    - [4. Topic è‡ªåŠ¨åˆ›å»º](#4-topic-%E8%87%AA%E5%8A%A8%E5%88%9B%E5%BB%BA)
    - [5. æ¶ˆè´¹è€…é…ç½®](#5-%E6%B6%88%E8%B4%B9%E8%80%85%E9%85%8D%E7%BD%AE)
    - [6. æ¶ˆæ¯ç”Ÿäº§è€…](#6-%E6%B6%88%E6%81%AF%E7%94%9F%E4%BA%A7%E8%80%85)
    - [7. æ¶ˆæ¯æ¶ˆè´¹è€…](#7-%E6%B6%88%E6%81%AF%E6%B6%88%E8%B4%B9%E8%80%85)
      - [æœ€æ–°åç§»é‡æ¶ˆè´¹è€…](#%E6%9C%80%E6%96%B0%E5%81%8F%E7%A7%BB%E9%87%8F%E6%B6%88%E8%B4%B9%E8%80%85)
      - [æœ€æ—©åç§»é‡æ¶ˆè´¹è€…](#%E6%9C%80%E6%97%A9%E5%81%8F%E7%A7%BB%E9%87%8F%E6%B6%88%E8%B4%B9%E8%80%85)
      - [æ‰‹åŠ¨åç§»é‡æ¶ˆè´¹è€…](#%E6%89%8B%E5%8A%A8%E5%81%8F%E7%A7%BB%E9%87%8F%E6%B6%88%E8%B4%B9%E8%80%85)
    - [8. åç§»é‡é‡ç½®æœåŠ¡](#8-%E5%81%8F%E7%A7%BB%E9%87%8F%E9%87%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1)
    - [9. REST æ§åˆ¶å™¨](#9-rest-%E6%8E%A7%E5%88%B6%E5%99%A8)
  - [API æ¥å£æµ‹è¯•](#api-%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95)
    - [å…³é”®ç«¯ç‚¹](#%E5%85%B3%E9%94%AE%E7%AB%AF%E7%82%B9)
    - [Windows 11 æµ‹è¯•æ–¹æ³•](#windows-11-%E6%B5%8B%E8%AF%95%E6%96%B9%E6%B3%95)
      - [æ–¹æ³•1ï¼šæµè§ˆå™¨ç›´æ¥æµ‹è¯•ï¼ˆæœ€ç®€å•ï¼‰](#%E6%96%B9%E6%B3%951%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9B%B4%E6%8E%A5%E6%B5%8B%E8%AF%95%E6%9C%80%E7%AE%80%E5%8D%95)
      - [æ–¹æ³•2ï¼šPowerShell æµ‹è¯•](#%E6%96%B9%E6%B3%952powershell-%E6%B5%8B%E8%AF%95)
      - [æ–¹æ³•3ï¼šcurl å‘½ä»¤æµ‹è¯•](#%E6%96%B9%E6%B3%953curl-%E5%91%BD%E4%BB%A4%E6%B5%8B%E8%AF%95)
  - [æ¼”ç¤ºæ­¥éª¤ä¸é¢„æœŸç»“æœ](#%E6%BC%94%E7%A4%BA%E6%AD%A5%E9%AA%A4%E4%B8%8E%E9%A2%84%E6%9C%9F%E7%BB%93%E6%9E%9C)
    - [1. å¯åŠ¨å‰å‡†å¤‡](#1-%E5%90%AF%E5%8A%A8%E5%89%8D%E5%87%86%E5%A4%87)
    - [2. å¯åŠ¨åº”ç”¨](#2-%E5%90%AF%E5%8A%A8%E5%BA%94%E7%94%A8)
    - [3. æ‰§è¡Œæµ‹è¯•](#3-%E6%89%A7%E8%A1%8C%E6%B5%8B%E8%AF%95)
      - [æ­¥éª¤1ï¼šæŸ¥çœ‹è¡Œä¸ºè¯´æ˜](#%E6%AD%A5%E9%AA%A41%E6%9F%A5%E7%9C%8B%E8%A1%8C%E4%B8%BA%E8%AF%B4%E6%98%8E)
      - [æ­¥éª¤2ï¼šæ‰¹é‡å‘é€æ¶ˆæ¯](#%E6%AD%A5%E9%AA%A42%E6%89%B9%E9%87%8F%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF)
      - [æ­¥éª¤3ï¼šå‘é€å•æ¡æ¶ˆæ¯](#%E6%AD%A5%E9%AA%A43%E5%8F%91%E9%80%81%E5%8D%95%E6%9D%A1%E6%B6%88%E6%81%AF)
      - [æ­¥éª¤4ï¼šé‡ç½®åç§»é‡](#%E6%AD%A5%E9%AA%A44%E9%87%8D%E7%BD%AE%E5%81%8F%E7%A7%BB%E9%87%8F)
    - [4. æŸ¥çœ‹æ¶ˆè´¹æ—¥å¿—](#4-%E6%9F%A5%E7%9C%8B%E6%B6%88%E8%B4%B9%E6%97%A5%E5%BF%97)
  - [ç”Ÿäº§ç¯å¢ƒå»ºè®®](#%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E5%BB%BA%E8%AE%AE)
  - [æ€»ç»“](#%E6%80%BB%E7%BB%93)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

# offsetåç§»é‡è¡Œä¸º

## ç›®æ ‡

æ¼”ç¤ºä¸åŒ `auto.offset.reset` ç­–ç•¥ä¸‹ï¼ˆlatest/earliestï¼‰ä»¥åŠæ‰‹åŠ¨æäº¤åç§»é‡æ—¶çš„æ¶ˆè´¹è¡Œä¸ºå·®å¼‚ï¼Œå¹¶æä¾›é€šè¿‡ Admin API
é‡ç½®æ¶ˆè´¹è€…ç»„åç§»é‡çš„ç¤ºä¾‹ã€‚

## é‡è¦Topicä¸æ¶ˆè´¹è€…ç»„

- **Topic**: `offset-demo-topic`
- **æ¶ˆè´¹è€…ç»„**ï¼š
    - `demo-group-latest` - æœ€æ–°åç§»é‡ç­–ç•¥
    - `demo-group-earliest` - æœ€æ—©åç§»é‡ç­–ç•¥
    - `demo-group-manual` - æ‰‹åŠ¨åç§»é‡æ§åˆ¶

## æ ¸å¿ƒæ¦‚å¿µ

### åç§»é‡ç­–ç•¥å¯¹æ¯”

| ç­–ç•¥         | è¡Œä¸º                       | é€‚ç”¨åœºæ™¯              |
|------------|--------------------------|-------------------|
| `latest`   | æ–°æ¶ˆè´¹è€…ç»„ä»æœ€æ–°ä½ç½®å¼€å§‹æ¶ˆè´¹ï¼Œä¸ä¼šæ”¶åˆ°å†å²æ¶ˆæ¯  | å®æ—¶æ•°æ®å¤„ç†ï¼Œä¸å…³å¿ƒå†å²æ¶ˆæ¯    |
| `earliest` | æ–°æ¶ˆè´¹è€…ç»„ä»æœ€æ—©ä½ç½®å¼€å§‹æ¶ˆè´¹ï¼Œä¼šæ”¶åˆ°æ‰€æœ‰å†å²æ¶ˆæ¯ | éœ€è¦å¤„ç†æ‰€æœ‰æ•°æ®ï¼ŒåŒ…æ‹¬å†å²æ¶ˆæ¯   |
| `manual`   | æ‰‹åŠ¨æ§åˆ¶åç§»é‡æäº¤ï¼Œå®ç°ç²¾ç¡®çš„æ¶ˆè´¹æ§åˆ¶      | éœ€è¦ç¡®ä¿æ¶ˆæ¯å¤„ç†æˆåŠŸåæ‰æäº¤åç§»é‡ |

### é‡è¦è¯´æ˜

âš ï¸ **æ³¨æ„**ï¼šå¦‚æœæ¶ˆè´¹è€…ç»„å·²æœ‰æäº¤çš„åç§»é‡ï¼Œ`auto.offset.reset` é…ç½®å°†ä¸ä¼šç”Ÿæ•ˆã€‚åªæœ‰æ–°æ¶ˆè´¹è€…ç»„æˆ–æ²¡æœ‰å·²æäº¤åç§»é‡çš„æ¶ˆè´¹è€…ç»„æ‰ä¼šä½¿ç”¨æ­¤é…ç½®ã€‚

---

## æŠ€æœ¯å®ç°

### 1. é¡¹ç›®ä¾èµ–

`pom.xml`ï¼šå¼•å…¥kafkaä¾èµ–

```xml

<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter</artifactId>
</dependency>
<dependency>
<groupId>org.springframework.boot</groupId>
<artifactId>spring-boot-starter-web</artifactId>
</dependency>
<dependency>
<groupId>org.springframework.kafka</groupId>
<artifactId>spring-kafka</artifactId>
</dependency>
<dependency>
<groupId>org.projectlombok</groupId>
<artifactId>lombok</artifactId>
<version>1.18.32</version>
<optional>true</optional>
</dependency>
```

### 2. åº”ç”¨é…ç½®

`application.yml`ï¼šæ·»åŠ kafkaé…ç½®

```yml
server:
  port: 8091

spring:
  application:
    name: kafka-03-offset
  kafka:
    # KafkaæœåŠ¡å™¨åœ°å€ï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”
    bootstrap-servers: 192.168.56.10:9092

    # ç”Ÿäº§è€…é…ç½®
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer
      acks: 1 # æ¶ˆæ¯ç¡®è®¤æœºåˆ¶

    # æ¶ˆè´¹è€…é…ç½®
    consumer:
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      enable-auto-commit: false # ç¦ç”¨è‡ªåŠ¨æäº¤ï¼Œä½¿ç”¨æ‰‹åŠ¨æ§åˆ¶

logging:
  level:
    org.apache.kafka.clients.NetworkClient: error
```

### 3. å¸¸é‡å®šä¹‰

`config/KafkaConstants.java` ç»Ÿä¸€ç®¡ç† Topic åç§°ã€åˆ†åŒºã€å‰¯æœ¬ç­‰å¸¸é‡

```java
package com.action.kafka03offset.config;

/**
 * Kafkaå¸¸é‡å®šä¹‰ç±»
 * ç»Ÿä¸€ç®¡ç†Topicåç§°ã€æ¶ˆè´¹è€…ç»„ã€åˆ†åŒºå’Œå‰¯æœ¬ç­‰é…ç½®å¸¸é‡
 */
public class KafkaConstants {

    /** æ¼”ç¤ºTopicåç§° */
    public static final String TOPIC_DEMO = "offset-demo-topic";

    /** æœ€æ–°åç§»é‡ç­–ç•¥æ¶ˆè´¹è€…ç»„ */
    public static final String CONSUMER_GROUP_LATEST = "demo-group-latest";
    /** æœ€æ—©åç§»é‡ç­–ç•¥æ¶ˆè´¹è€…ç»„ */
    public static final String CONSUMER_GROUP_EARLIEST = "demo-group-earliest";
    /** æ‰‹åŠ¨åç§»é‡æ§åˆ¶æ¶ˆè´¹è€…ç»„ */
    public static final String CONSUMER_GROUP_MANUAL = "demo-group-manual";

    /** Topicåˆ†åŒºæ•°é‡ */
    public static final int DEMO_TOPIC_PARTITIONS = 2;
    /** Topicå‰¯æœ¬å› å­ */
    public static final short DEMO_TOPIC_REPLICATION_FACTOR = 1;
}
```

### 4. Topic è‡ªåŠ¨åˆ›å»º

`config/KafkaTopicConfig.java` åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»º Topicï¼Œé¿å…æ‰‹åŠ¨å‘½ä»¤è¡Œåˆ›å»º

```java
package com.action.kafka03offset.config;

import org.apache.kafka.clients.admin.NewTopic;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.kafka.config.TopicBuilder;

/**
 * Kafka Topicé…ç½®ç±»
 * åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºTopicï¼Œé¿å…æ‰‹åŠ¨å‘½ä»¤è¡Œåˆ›å»º
 */
@Configuration
public class KafkaTopicConfig {

    /**
     * åˆ›å»ºæ¼”ç¤ºTopic
     * ä½¿ç”¨TopicBuilderæ„å»ºTopicé…ç½®
     * åº”ç”¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºè¯¥Topic
     */
    @Bean
    public NewTopic demoTopic() {
        return TopicBuilder.name(KafkaConstants.TOPIC_DEMO)
                .partitions(KafkaConstants.DEMO_TOPIC_PARTITIONS)
                .replicas(KafkaConstants.DEMO_TOPIC_REPLICATION_FACTOR)
                .build();
    }
}
```

### 5. æ¶ˆè´¹è€…é…ç½®

`config/CustomConsumerConfig.java` æ¼”ç¤ºä¸åŒåç§»é‡ç­–ç•¥çš„æ¶ˆè´¹è€…é…ç½®

```java
package com.action.kafka03offset.config;

import java.util.HashMap;
import java.util.Map;

import org.apache.kafka.clients.consumer.ConsumerConfig;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.kafka.config.ConcurrentKafkaListenerContainerFactory;
import org.springframework.kafka.core.ConsumerFactory;
import org.springframework.kafka.core.DefaultKafkaConsumerFactory;
import org.springframework.kafka.listener.ContainerProperties;

/**
 * Kafkaæ¶ˆè´¹è€…é…ç½®ç±»
 * æ¼”ç¤ºä¸åŒåç§»é‡ç­–ç•¥çš„æ¶ˆè´¹è€…é…ç½®ï¼š
 * 1. latestOffsetFactory - ä»æœ€æ–°ä½ç½®å¼€å§‹æ¶ˆè´¹ï¼ˆé»˜è®¤ç­–ç•¥ï¼‰
 * 2. earliestOffsetFactory - ä»æœ€æ—©ä½ç½®å¼€å§‹æ¶ˆè´¹
 * 3. manualOffsetFactory - æ‰‹åŠ¨æ§åˆ¶åç§»é‡æäº¤
 */
@Configuration
public class CustomConsumerConfig {

    /**
     * æœ€æ–°åç§»é‡æ¶ˆè´¹è€…å·¥å‚
     * ä½¿ç”¨é»˜è®¤çš„auto.offset.reset=latestç­–ç•¥
     * æ–°æ¶ˆè´¹è€…ç»„ä»æœ€æ–°ä½ç½®å¼€å§‹æ¶ˆè´¹ï¼Œä¸ä¼šæ”¶åˆ°å†å²æ¶ˆæ¯
     */
    @Bean
    public ConcurrentKafkaListenerContainerFactory<String, String> latestOffsetFactory(
            ConsumerFactory<String, String> consumerFactory) {
        ConcurrentKafkaListenerContainerFactory<String, String> factory =
                new ConcurrentKafkaListenerContainerFactory<>();
        factory.setConsumerFactory(consumerFactory);
        return factory;
    }

    /**
     * æœ€æ—©åç§»é‡æ¶ˆè´¹è€…å·¥å‚
     * æ˜¾å¼è®¾ç½®auto.offset.reset=earliestç­–ç•¥
     * æ–°æ¶ˆè´¹è€…ç»„ä»æœ€æ—©ä½ç½®å¼€å§‹æ¶ˆè´¹ï¼Œä¼šæ”¶åˆ°æ‰€æœ‰å†å²æ¶ˆæ¯
     */
    @Bean
    public ConcurrentKafkaListenerContainerFactory<String, String> earliestOffsetFactory(
            ConsumerFactory<String, String> consumerFactory) {

        // å¤åˆ¶åŸæœ‰é…ç½®å¹¶æ·»åŠ earliestç­–ç•¥
        Map<String, Object> props = new HashMap<>();
        props.putAll(consumerFactory.getConfigurationProperties());
        props.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, "earliest");

        // åˆ›å»ºæ–°çš„æ¶ˆè´¹è€…å·¥å‚
        ConsumerFactory<String, String> earliestConsumerFactory =
                new DefaultKafkaConsumerFactory<>(props);

        ConcurrentKafkaListenerContainerFactory<String, String> factory =
                new ConcurrentKafkaListenerContainerFactory<>();
        factory.setConsumerFactory(earliestConsumerFactory);
        return factory;
    }

    /**
     * æ‰‹åŠ¨åç§»é‡æ¶ˆè´¹è€…å·¥å‚
     * è®¾ç½®æ‰‹åŠ¨ç«‹å³æäº¤åç§»é‡æ¨¡å¼
     * å…è®¸ç²¾ç¡®æ§åˆ¶æ¶ˆæ¯å¤„ç†å®Œæˆåå†æäº¤åç§»é‡
     */
    @Bean
    public ConcurrentKafkaListenerContainerFactory<String, String> manualOffsetFactory(
            ConsumerFactory<String, String> consumerFactory) {

        ConcurrentKafkaListenerContainerFactory<String, String> factory =
                new ConcurrentKafkaListenerContainerFactory<>();
        factory.setConsumerFactory(consumerFactory);
        // è®¾ç½®æ‰‹åŠ¨ç«‹å³æäº¤æ¨¡å¼ï¼Œéœ€è¦æ‰‹åŠ¨è°ƒç”¨ack.acknowledge()
        factory.getContainerProperties().setAckMode(ContainerProperties.AckMode.MANUAL_IMMEDIATE);
        return factory;
    }
}
```

### 6. æ¶ˆæ¯ç”Ÿäº§è€…

`producer/KafkaProducer.java` é€šè¿‡ KafkaTemplate å¼‚æ­¥å‘é€æ¶ˆæ¯åˆ°æŒ‡å®š Topic

```java
package com.action.kafka03offset.producer;

import com.action.kafka03offset.config.KafkaConstants;
import lombok.extern.slf4j.Slf4j;
import org.springframework.kafka.core.KafkaTemplate;
import org.springframework.stereotype.Service;

/**
 * Kafkaæ¶ˆæ¯ç”Ÿäº§è€…
 * é€šè¿‡KafkaTemplateå¼‚æ­¥å‘é€æ¶ˆæ¯åˆ°æŒ‡å®šTopic
 * æ”¯æŒå•æ¡æ¶ˆæ¯å‘é€å’Œæ‰¹é‡æ¶ˆæ¯å‘é€
 */
@Service
@Slf4j
public class KafkaProducer {

    private final KafkaTemplate<String, String> kafkaTemplate;

    public KafkaProducer(KafkaTemplate<String, String> kafkaTemplate) {
        this.kafkaTemplate = kafkaTemplate;
    }

    /**
     * å‘é€å•æ¡æ¼”ç¤ºæ¶ˆæ¯
     * ä½¿ç”¨å¼‚æ­¥æ–¹å¼å‘é€ï¼Œé€šè¿‡å›è°ƒå¤„ç†å‘é€ç»“æœ
     *
     * @param message è¦å‘é€çš„æ¶ˆæ¯å†…å®¹
     */
    public void sendDemoMessage(String message) {
        log.info("å‘é€æ¼”ç¤ºæ¶ˆæ¯: {}", message);

        // å¼‚æ­¥å‘é€æ¶ˆæ¯ï¼Œä½¿ç”¨whenCompleteå¤„ç†ç»“æœ
        kafkaTemplate.send(KafkaConstants.TOPIC_DEMO, message)
                .whenComplete((result, ex) -> {
                    if (ex == null) {
                        // å‘é€æˆåŠŸï¼Œè®°å½•åˆ†åŒºå’Œåç§»é‡ä¿¡æ¯
                        log.info("âœ… æ¶ˆæ¯å‘é€æˆåŠŸ: partition={}, offset={}",
                                result.getRecordMetadata().partition(),
                                result.getRecordMetadata().offset());
                    } else {
                        // å‘é€å¤±è´¥ï¼Œè®°å½•é”™è¯¯ä¿¡æ¯
                        log.error("âŒ æ¶ˆæ¯å‘é€å¤±è´¥: {}", ex.getMessage());
                    }
                });
    }

    /**
     * æ‰¹é‡å‘é€æµ‹è¯•æ¶ˆæ¯
     * ç”¨äºæ¼”ç¤ºä¸åŒåç§»é‡ç­–ç•¥çš„æ¶ˆè´¹è¡Œä¸º
     *
     * @param count è¦å‘é€çš„æ¶ˆæ¯æ•°é‡
     */
    public void sendBatchMessages(int count) {
        log.info("å¼€å§‹æ‰¹é‡å‘é€ {} æ¡æµ‹è¯•æ¶ˆæ¯", count);
        for (int i = 1; i <= count; i++) {
            // ç”Ÿæˆå¸¦æ—¶é—´æˆ³çš„æµ‹è¯•æ¶ˆæ¯
            String message = "æµ‹è¯•æ¶ˆæ¯-" + i + "-" + System.currentTimeMillis();
            kafkaTemplate.send(KafkaConstants.TOPIC_DEMO, message);
        }
        log.info("âœ… æ‰¹é‡æ¶ˆæ¯å‘é€å®Œæˆ");
    }
}
```

### 7. æ¶ˆæ¯æ¶ˆè´¹è€…

#### æœ€æ–°åç§»é‡æ¶ˆè´¹è€…

`consumer/LatestOffsetConsumer.java` ä½¿ç”¨ `@KafkaListener` æ³¨è§£ç›‘å¬ Topicï¼Œä»æœ€æ–°ä½ç½®å¼€å§‹æ¶ˆè´¹

```java
package com.action.kafka03offset.consumer;

import com.action.kafka03offset.config.KafkaConstants;
import lombok.extern.slf4j.Slf4j;
import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.stereotype.Component;

/**
 * æœ€æ–°åç§»é‡ç­–ç•¥æ¶ˆè´¹è€…
 * ä½¿ç”¨latestOffsetFactoryï¼Œä»æœ€æ–°ä½ç½®å¼€å§‹æ¶ˆè´¹
 * æ–°æ¶ˆè´¹è€…ç»„ä¸ä¼šæ”¶åˆ°å†å²æ¶ˆæ¯ï¼Œåªæ¶ˆè´¹å¯åŠ¨åçš„æ–°æ¶ˆæ¯
 */
@Component
@Slf4j
public class LatestOffsetConsumer {

    /**
     * æ¶ˆè´¹æœ€æ–°åç§»é‡ç­–ç•¥çš„æ¶ˆæ¯
     * ä½¿ç”¨@KafkaListeneræ³¨è§£ç›‘å¬æŒ‡å®šTopicå’Œæ¶ˆè´¹è€…ç»„
     * containerFactoryæŒ‡å®šä½¿ç”¨latestOffsetFactoryé…ç½®
     */
    @KafkaListener(
            topics = KafkaConstants.TOPIC_DEMO,
            groupId = KafkaConstants.CONSUMER_GROUP_LATEST,
            containerFactory = "latestOffsetFactory"
    )
    public void consumeLatest(String message) {
        log.info("ğŸ”µ [LATESTç»„] æ¶ˆè´¹æ¶ˆæ¯: {}", message);
    }
}
```

#### æœ€æ—©åç§»é‡æ¶ˆè´¹è€…

`consumer/EarliestOffsetConsumer.java` ä»æœ€æ—©ä½ç½®å¼€å§‹æ¶ˆè´¹ï¼Œä¼šæ”¶åˆ°æ‰€æœ‰å†å²æ¶ˆæ¯

```java
package com.action.kafka03offset.consumer;

import com.action.kafka03offset.config.KafkaConstants;
import lombok.extern.slf4j.Slf4j;
import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.stereotype.Component;

/**
 * æœ€æ—©åç§»é‡ç­–ç•¥æ¶ˆè´¹è€…
 * ä½¿ç”¨earliestOffsetFactoryï¼Œä»æœ€æ—©ä½ç½®å¼€å§‹æ¶ˆè´¹
 * æ–°æ¶ˆè´¹è€…ç»„ä¼šæ”¶åˆ°æ‰€æœ‰å†å²æ¶ˆæ¯ï¼ŒåŒ…æ‹¬å¯åŠ¨å‰å·²å­˜åœ¨çš„æ¶ˆæ¯
 */
@Component
@Slf4j
public class EarliestOffsetConsumer {

    /**
     * æ¶ˆè´¹æœ€æ—©åç§»é‡ç­–ç•¥çš„æ¶ˆæ¯
     * ä½¿ç”¨@KafkaListeneræ³¨è§£ç›‘å¬æŒ‡å®šTopicå’Œæ¶ˆè´¹è€…ç»„
     * containerFactoryæŒ‡å®šä½¿ç”¨earliestOffsetFactoryé…ç½®
     */
    @KafkaListener(
            topics = KafkaConstants.TOPIC_DEMO,
            groupId = KafkaConstants.CONSUMER_GROUP_EARLIEST,
            containerFactory = "earliestOffsetFactory"
    )
    public void consumeEarliest(String message) {
        log.info("ğŸŸ¢ [EARLIESTç»„] æ¶ˆè´¹æ¶ˆæ¯: {}", message);
    }
}
```

#### æ‰‹åŠ¨åç§»é‡æ¶ˆè´¹è€…

`consumer/ManualOffsetConsumer.java` æ‰‹åŠ¨æ§åˆ¶åç§»é‡æäº¤ï¼Œç¡®ä¿æ¶ˆæ¯å¤„ç†æˆåŠŸåæ‰æäº¤

```java
package com.action.kafka03offset.consumer;

import com.action.kafka03offset.config.KafkaConstants;
import lombok.extern.slf4j.Slf4j;
import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.kafka.support.Acknowledgment;
import org.springframework.stereotype.Component;

/**
 * æ‰‹åŠ¨åç§»é‡æ§åˆ¶æ¶ˆè´¹è€…
 * ä½¿ç”¨manualOffsetFactoryï¼Œæ‰‹åŠ¨æ§åˆ¶åç§»é‡æäº¤
 * åªæœ‰åœ¨æ¶ˆæ¯å¤„ç†æˆåŠŸåæ‰æäº¤åç§»é‡ï¼Œç¡®ä¿æ¶ˆæ¯ä¸ä¸¢å¤±
 */
@Component
@Slf4j
public class ManualOffsetConsumer {

    /**
     * æ¶ˆè´¹æ‰‹åŠ¨åç§»é‡æ§åˆ¶çš„æ¶ˆæ¯
     * ä½¿ç”¨@KafkaListeneræ³¨è§£ç›‘å¬æŒ‡å®šTopicå’Œæ¶ˆè´¹è€…ç»„
     * containerFactoryæŒ‡å®šä½¿ç”¨manualOffsetFactoryé…ç½®
     * Acknowledgmentå‚æ•°ç”¨äºæ‰‹åŠ¨æäº¤åç§»é‡
     */
    @KafkaListener(
            topics = KafkaConstants.TOPIC_DEMO,
            groupId = KafkaConstants.CONSUMER_GROUP_MANUAL,
            containerFactory = "manualOffsetFactory"
    )
    public void consumeManual(String message, Acknowledgment ack) {
        try {
            log.info("ğŸŸ  [MANUALç»„] æ¶ˆè´¹æ¶ˆæ¯: {}", message);
            // å¤„ç†æ¶ˆæ¯
            processMessage(message);
            // æ¶ˆæ¯å¤„ç†æˆåŠŸåæ‰‹åŠ¨æäº¤åç§»é‡
            ack.acknowledge();
            log.info("âœ… åç§»é‡å·²æäº¤");
        } catch (Exception e) {
            log.error("âŒ æ¶ˆæ¯å¤„ç†å¤±è´¥: {}", e.getMessage());
            // å¤„ç†å¤±è´¥æ—¶ä¸æäº¤åç§»é‡ï¼Œæ¶ˆæ¯ä¼šè¢«é‡æ–°æ¶ˆè´¹
        }
    }

    /**
     * æ¨¡æ‹Ÿæ¶ˆæ¯å¤„ç†é€»è¾‘
     * å¦‚æœæ¶ˆæ¯åŒ…å«"error"å…³é”®å­—ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸æ¨¡æ‹Ÿå¤„ç†å¤±è´¥
     */
    private void processMessage(String message) {
        if (message.contains("error")) {
            throw new RuntimeException("æ¨¡æ‹Ÿä¸šåŠ¡å¤„ç†å¼‚å¸¸");
        }
    }
}
```

### 8. åç§»é‡é‡ç½®æœåŠ¡

`service/OffsetResetService.java` é€šè¿‡ Admin API é‡ç½®æ¶ˆè´¹è€…ç»„åç§»é‡

```java
package com.action.kafka03offset.service;

import lombok.extern.slf4j.Slf4j;
import org.apache.kafka.clients.admin.*;
import org.apache.kafka.clients.consumer.OffsetAndMetadata;
import org.apache.kafka.common.TopicPartition;
import org.springframework.kafka.core.KafkaAdmin;
import org.springframework.stereotype.Service;

import java.util.*;
import java.util.concurrent.TimeUnit;
import java.util.stream.Collectors;

/**
 * åç§»é‡é‡ç½®æœåŠ¡
 * é€šè¿‡Kafka Admin APIé‡ç½®æ¶ˆè´¹è€…ç»„çš„åç§»é‡
 * æ”¯æŒé‡ç½®åˆ°earliestæˆ–latestä½ç½®
 */
@Service
@Slf4j
public class OffsetResetService {

    private final KafkaAdmin kafkaAdmin;

    public OffsetResetService(KafkaAdmin kafkaAdmin) {
        this.kafkaAdmin = kafkaAdmin;
    }

    /**
     * é‡ç½®æ¶ˆè´¹è€…ç»„åç§»é‡
     * ä½¿ç”¨Admin APIå°†æŒ‡å®šæ¶ˆè´¹è€…ç»„çš„åç§»é‡é‡ç½®åˆ°æŒ‡å®šä½ç½®
     *
     * @param groupId æ¶ˆè´¹è€…ç»„ID
     * @param topic Topicåç§°
     * @param resetTo é‡ç½®ç›®æ ‡ä½ç½®ï¼ˆearliest/latestï¼‰
     */
    public void resetConsumerOffset(String groupId, String topic, String resetTo) {
        try (AdminClient adminClient = AdminClient.create(kafkaAdmin.getConfigurationProperties())) {

            // è·å–Topicçš„æ‰€æœ‰åˆ†åŒº
            Set<TopicPartition> partitions = getTopicPartitions(adminClient, topic);
            if (partitions.isEmpty()) {
                throw new RuntimeException("Topic " + topic + " ä¸å­˜åœ¨æˆ–æ²¡æœ‰åˆ†åŒº");
            }

            // å‡†å¤‡æ–°çš„åç§»é‡æ˜ å°„
            Map<TopicPartition, OffsetAndMetadata> newOffsets = new HashMap<>();

            // æ ¹æ®é‡ç½®ç­–ç•¥è·å–ç›®æ ‡åç§»é‡
            Map<TopicPartition, ListOffsetsResult.ListOffsetsResultInfo> offsets;
            if ("earliest".equalsIgnoreCase(resetTo)) {
                // é‡ç½®åˆ°æœ€æ—©ä½ç½®
                Map<TopicPartition, OffsetSpec> spec = partitions.stream()
                        .collect(Collectors.toMap(tp -> tp, tp -> OffsetSpec.earliest()));
                offsets = adminClient.listOffsets(spec).all().get(10, TimeUnit.SECONDS);
            } else if ("latest".equalsIgnoreCase(resetTo)) {
                // é‡ç½®åˆ°æœ€æ–°ä½ç½®
                Map<TopicPartition, OffsetSpec> spec = partitions.stream()
                        .collect(Collectors.toMap(tp -> tp, tp -> OffsetSpec.latest()));
                offsets = adminClient.listOffsets(spec).all().get(10, TimeUnit.SECONDS);
            } else {
                throw new IllegalArgumentException("ä¸æ”¯æŒçš„resetToå‚æ•°: " + resetTo);
            }

            // æ„å»ºæ–°çš„åç§»é‡æ˜ å°„
            for (Map.Entry<TopicPartition, ListOffsetsResult.ListOffsetsResultInfo> e : offsets.entrySet()) {
                newOffsets.put(e.getKey(), new OffsetAndMetadata(e.getValue().offset()));
            }

            // æ‰§è¡Œåç§»é‡é‡ç½®
            adminClient.alterConsumerGroupOffsets(groupId, newOffsets).all().get(10, TimeUnit.SECONDS);
            log.info("âœ… æ¶ˆè´¹è€…ç»„ {} çš„åç§»é‡å·²é‡ç½®åˆ° {}", groupId, resetTo);
        } catch (Exception e) {
            log.error("âŒ é‡ç½®æ¶ˆè´¹è€…ç»„åç§»é‡å¤±è´¥: {}", e.getMessage());
            throw new RuntimeException("é‡ç½®å¤±è´¥", e);
        }
    }

    /**
     * è·å–Topicçš„æ‰€æœ‰åˆ†åŒºä¿¡æ¯
     *
     * @param adminClient Adminå®¢æˆ·ç«¯
     * @param topic Topicåç§°
     * @return åˆ†åŒºé›†åˆ
     * @throws Exception å¼‚å¸¸
     */
    private Set<TopicPartition> getTopicPartitions(AdminClient adminClient, String topic) throws Exception {
        DescribeTopicsResult topicsResult = adminClient.describeTopics(Collections.singleton(topic));
        TopicDescription topicDescription = topicsResult.topicNameValues().get(topic).get();
        return topicDescription.partitions().stream()
                .map(p -> new TopicPartition(topic, p.partition()))
                .collect(Collectors.toSet());
    }
}
```

### 9. REST æ§åˆ¶å™¨

`controller/KafkaController.java` æä¾› REST æ¥å£ç”¨äºæµ‹è¯•ä¸åŒåç§»é‡ç­–ç•¥çš„æ¶ˆè´¹è¡Œä¸º

```java
package com.action.kafka03offset.controller;

import com.action.kafka03offset.producer.KafkaProducer;
import com.action.kafka03offset.service.OffsetResetService;
import lombok.extern.slf4j.Slf4j;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.HashMap;
import java.util.Map;

/**
 * Kafkaæ¼”ç¤ºæ§åˆ¶å™¨
 * æä¾›RESTæ¥å£ç”¨äºæµ‹è¯•ä¸åŒåç§»é‡ç­–ç•¥çš„æ¶ˆè´¹è¡Œä¸º
 * æ‰€æœ‰æ¥å£éƒ½ä½¿ç”¨GETæ–¹æ³•ï¼Œç®€åŒ–æµ‹è¯•
 */
@RestController
@RequestMapping("/api/kafka/demo")
@Slf4j
public class KafkaController {

    private final KafkaProducer kafkaProducer;
    private final OffsetResetService offsetResetService;

    public KafkaController(KafkaProducer kafkaProducer, OffsetResetService offsetResetService) {
        this.kafkaProducer = kafkaProducer;
        this.offsetResetService = offsetResetService;
    }

    /**
     * å‘é€å•æ¡æ¶ˆæ¯æ¥å£
     * ç”¨äºæµ‹è¯•ä¸åŒæ¶ˆè´¹è€…ç»„çš„æ¶ˆè´¹è¡Œä¸º
     *
     * @param message è¦å‘é€çš„æ¶ˆæ¯å†…å®¹
     * @return å‘é€ç»“æœ
     */
    @GetMapping("/send")
    public ResponseEntity<String> sendMessage(@RequestParam String message) {
        kafkaProducer.sendDemoMessage(message);
        return ResponseEntity.ok("æ¶ˆæ¯å·²å‘é€: " + message);
    }

    /**
     * æ‰¹é‡å‘é€æ¶ˆæ¯æ¥å£
     * ç”¨äºç”Ÿæˆæµ‹è¯•æ•°æ®ï¼Œæ¼”ç¤ºä¸åŒåç§»é‡ç­–ç•¥
     *
     * @param count è¦å‘é€çš„æ¶ˆæ¯æ•°é‡ï¼Œé»˜è®¤10æ¡
     * @return å‘é€ç»“æœ
     */
    @GetMapping("/send-batch")
    public ResponseEntity<String> sendBatchMessages(@RequestParam(defaultValue = "10") int count) {
        kafkaProducer.sendBatchMessages(count);
        return ResponseEntity.ok("å·²å‘é€ " + count + " æ¡æµ‹è¯•æ¶ˆæ¯");
    }

    /**
     * é‡ç½®æ¶ˆè´¹è€…ç»„åç§»é‡æ¥å£
     * é€šè¿‡Admin APIé‡ç½®æŒ‡å®šæ¶ˆè´¹è€…ç»„çš„åç§»é‡
     *
     * @param groupId æ¶ˆè´¹è€…ç»„ID
     * @param topic Topicåç§°
     * @param resetTo é‡ç½®ç›®æ ‡ä½ç½®ï¼ˆearliest/latestï¼‰
     * @return é‡ç½®ç»“æœ
     */
    @GetMapping("/reset-offset")
    public ResponseEntity<String> resetOffset(@RequestParam String groupId,
                                              @RequestParam String topic,
                                              @RequestParam(defaultValue = "earliest") String resetTo) {
        try {
            offsetResetService.resetConsumerOffset(groupId, topic, resetTo);
            return ResponseEntity.ok("æ¶ˆè´¹è€…ç»„ " + groupId + " åç§»é‡å·²é‡ç½®åˆ° " + resetTo);
        } catch (Exception e) {
            return ResponseEntity.badRequest().body("é‡ç½®å¤±è´¥: " + e.getMessage());
        }
    }

}
```

---

## API æ¥å£æµ‹è¯•

### å…³é”®ç«¯ç‚¹

æ‰€æœ‰æ¥å£éƒ½ä½¿ç”¨ GET æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•ï¼š

- **å‘é€å•æ¡æ¶ˆæ¯**ï¼š
  ```
  http://localhost:8091/api/kafka/demo/send?message=hello
  ```

- **æ‰¹é‡å‘é€æ¶ˆæ¯**ï¼š
  ```
  http://localhost:8091/api/kafka/demo/send-batch?count=5
  ```

- **é‡ç½®åç§»é‡**ï¼š
  ```
  http://localhost:8091/api/kafka/demo/reset-offset?groupId=demo-group-latest&topic=offset-demo-topic&resetTo=earliest
  ```

### Windows 11 æµ‹è¯•æ–¹æ³•

#### æ–¹æ³•1ï¼šæµè§ˆå™¨ç›´æ¥æµ‹è¯•ï¼ˆæœ€ç®€å•ï¼‰

ç›´æ¥åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ä¸Šè¿°URLå³å¯æµ‹è¯•ã€‚

#### æ–¹æ³•2ï¼šPowerShell æµ‹è¯•

```powershell
# å‘é€å•æ¡æ¶ˆæ¯
Invoke-RestMethod -Uri "http://localhost:8091/api/kafka/demo/send?message=hello"

# æ‰¹é‡å‘é€æ¶ˆæ¯
Invoke-RestMethod -Uri "http://localhost:8091/api/kafka/demo/send-batch?count=5"

# é‡ç½®åç§»é‡
Invoke-RestMethod -Uri "http://localhost:8091/api/kafka/demo/reset-offset?groupId=demo-group-latest&topic=offset-demo-topic&resetTo=earliest"

# æŸ¥çœ‹è¡Œä¸ºè¯´æ˜
Invoke-RestMethod -Uri "http://localhost:8091/api/kafka/demo/behavior"
```

#### æ–¹æ³•3ï¼šcurl å‘½ä»¤æµ‹è¯•

```bash
# å‘é€å•æ¡æ¶ˆæ¯
curl "http://localhost:8091/api/kafka/demo/send?message=hello"

# æ‰¹é‡å‘é€æ¶ˆæ¯
curl "http://localhost:8091/api/kafka/demo/send-batch?count=5"

# é‡ç½®åç§»é‡
curl "http://localhost:8091/api/kafka/demo/reset-offset?groupId=demo-group-latest&topic=offset-demo-topic&resetTo=earliest"
```

---

## æ¼”ç¤ºæ­¥éª¤ä¸é¢„æœŸç»“æœ

### 1. å¯åŠ¨å‰å‡†å¤‡

ç¡®ä¿ Kafka æœåŠ¡è¿è¡Œï¼Œ`offset-demo-topic` ä¸å­˜åœ¨æˆ–ä¸ºç©ºã€‚

### 2. å¯åŠ¨åº”ç”¨

```bash
mvn spring-boot:run
```

åº”ç”¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åˆ›å»º Topicã€‚

### 3. æ‰§è¡Œæµ‹è¯•

#### æ­¥éª¤1ï¼šæŸ¥çœ‹è¡Œä¸ºè¯´æ˜

```
http://localhost:8091/api/kafka/demo/behavior
```

#### æ­¥éª¤2ï¼šæ‰¹é‡å‘é€æ¶ˆæ¯

```
http://localhost:8091/api/kafka/demo/send-batch?count=5
```

**é¢„æœŸç»“æœ**ï¼š

- `latestç»„`ï¼šä¸ä¼šæ¶ˆè´¹å†å²æ¶ˆæ¯ï¼ˆä»æœ€æ–°ä½ç½®ï¼‰
- `earliestç»„`ï¼šä¼šæ¶ˆè´¹å…¨éƒ¨å†å²æ¶ˆæ¯ï¼ˆä»æœ€æ—©ä½ç½®ï¼‰
- `manualç»„`ï¼šæŒ‰æ‰‹åŠ¨æäº¤é€»è¾‘å¤„ç†

#### æ­¥éª¤3ï¼šå‘é€å•æ¡æ¶ˆæ¯

```
http://localhost:8091/api/kafka/demo/send?message=æ–°æ¶ˆæ¯
```

**é¢„æœŸç»“æœ**ï¼šä¸‰ä¸ªç»„éƒ½ä¼šæ¶ˆè´¹ï¼ˆå·²æœ‰æäº¤åç§»é‡ï¼‰

#### æ­¥éª¤4ï¼šé‡ç½®åç§»é‡

```
http://localhost:8091/api/kafka/demo/reset-offset?groupId=demo-group-latest&topic=offset-demo-topic&resetTo=earliest
```

**é¢„æœŸç»“æœ**ï¼š`demo-group-latest` ä¼šé‡æ–°æ¶ˆè´¹å†å²æ¶ˆæ¯

### 4. æŸ¥çœ‹æ¶ˆè´¹æ—¥å¿—

æ§åˆ¶å°å¯è§ç”Ÿäº§å’Œæ¶ˆè´¹çš„è¯¦ç»†æ—¥å¿—ï¼š

```
c.a.k.producer.KafkaProducer             : å‘é€æ¼”ç¤ºæ¶ˆæ¯: æµ‹è¯•æ¶ˆæ¯-1-1703123456789
c.a.k.producer.KafkaProducer             : âœ… æ¶ˆæ¯å‘é€æˆåŠŸ: partition=0, offset=0
c.a.k.consumer.LatestOffsetConsumer      : ğŸ”µ [LATESTç»„] æ¶ˆè´¹æ¶ˆæ¯: æµ‹è¯•æ¶ˆæ¯-1-1703123456789
c.a.k.consumer.EarliestOffsetConsumer    : ğŸŸ¢ [EARLIESTç»„] æ¶ˆè´¹æ¶ˆæ¯: æµ‹è¯•æ¶ˆæ¯-1-1703123456789
c.a.k.consumer.ManualOffsetConsumer      : ğŸŸ  [MANUALç»„] æ¶ˆè´¹æ¶ˆæ¯: æµ‹è¯•æ¶ˆæ¯-1-1703123456789
c.a.k.consumer.ManualOffsetConsumer      : âœ… åç§»é‡å·²æäº¤
```

---

## ç”Ÿäº§ç¯å¢ƒå»ºè®®

1. **æ˜ç¡®è®¾ç½®åç§»ç­–ç•¥**ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„ `auto.offset.reset` ç­–ç•¥
2. **ç›‘æ§æ¶ˆè´¹è€…æ»å**ï¼šä½¿ç”¨ Kafka ç›‘æ§å·¥å…·ç›‘æ§æ¶ˆè´¹è€…ç»„çš„æ¶ˆè´¹è¿›åº¦
3. **å»ºç«‹åç§»é‡ç½®æµç¨‹**ï¼šåˆ¶å®šæ ‡å‡†åŒ–çš„åç§»é‡é‡ç½®æµç¨‹å’Œå®¡æ‰¹æœºåˆ¶
4. **æ¶ˆæ¯å¹‚ç­‰æ€§**ï¼šç¡®ä¿æ¶ˆæ¯å¤„ç†é€»è¾‘çš„å¹‚ç­‰æ€§ï¼Œé¿å…é‡å¤æ¶ˆè´¹é€ æˆçš„é—®é¢˜
5. **é”™è¯¯å¤„ç†**ï¼šå»ºç«‹å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

---

## æ€»ç»“

æœ¬æ¨¡å—é€šè¿‡å®é™…ä»£ç æ¼”ç¤ºäº† Kafka ä¸­ä¸åŒåç§»é‡ç­–ç•¥çš„è¡Œä¸ºå·®å¼‚ï¼š

- **latest ç­–ç•¥**ï¼šé€‚åˆå®æ—¶æ•°æ®å¤„ç†åœºæ™¯
- **earliest ç­–ç•¥**ï¼šé€‚åˆéœ€è¦å¤„ç†æ‰€æœ‰æ•°æ®çš„åœºæ™¯
- **manual ç­–ç•¥**ï¼šé€‚åˆéœ€è¦ç²¾ç¡®æ§åˆ¶æ¶ˆæ¯å¤„ç†çš„åœºæ™¯

é€šè¿‡ Admin API å¯ä»¥åŠ¨æ€é‡ç½®æ¶ˆè´¹è€…ç»„åç§»é‡ï¼Œä¸ºç”Ÿäº§ç¯å¢ƒæä¾›äº†çµæ´»çš„æ•°æ®é‡æ”¾èƒ½åŠ›ã€‚
